#-*- coding: utf-8 -*-# # Define your item pipelines here## Don't forget to add your pipeline to the ITEM_PIPELINES setting# See: http://doc.scrapy.org/en/latest/topics/item-pipeline.htmlfrom scrapy.conf import settingsimport pymongo# import jieba# from wordcloud import WordCloud# import matplotlib.pyplot as pltimport sysreload(sys)sys.setdefaultencoding("utf-8")# def wordCloud(id,comments):# 	#comments = ["你好啊李银河", "我很好王小波同学"]# 	space_split = ""# 	for comment in comments:# 		line = comment# 		wordlist_after_jieba = jieba.cut(line, cut_all=True)# 		wl_space_split = " ".join(wordlist_after_jieba)# 		space_split += " "# 		space_split += wl_space_split# 		pass# 	#print("类型：" + (str)(type(space_split) is str))# 	#print(space_split)# 	my_wordcloud = WordCloud(background_color='white', font_path = "/System/Library/Fonts/PingFang.ttc").generate(# 		space_split)# 	plt.figure(figsize=(10, 8), dpi=600)# 	plt.imshow(my_wordcloud)# 	plt.axis("off")# 	plt.savefig("picture/"+id+".png", dpi=600)# 	plt.close('all')class TaobaoSpiderPipeline(object):	def __init__(self):		self.client = pymongo.MongoClient(host=settings['MONGO_HOST'],port=settings['MONGO_PORT'])		self.db=self.client[settings['MONGO_DB']]		self.coll=self.db[settings['MONGO_COLL']]	def process_item(self, item, spider):		title=item['title'][0]		link=item['link']		shop=item['shop']		address=item['address']		originPrice=item['originPrice'][0]		#nowPrice=item['nowPrice'][0]		comment=item['comment']		id=item['id']		# wordCloud(comments=comment,id=title)		print('商品标题\t',title)		print('商品id\t\t', id)		print('商品链接\t',link)		print('店铺\t\t',shop)		print('价格\t\t',originPrice)		#print('现价\t',nowPrice)		print('地址\t\t',address)		print('评论\t\t',comment)		print('-----------------------------------\n')		# postItem=dict(商品标题=title,商品链接=link,店铺=shop,价格=originPrice,地址=address,评论=comment)		# self.coll.insert(postItem)		return item